<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>CineLux Vadodara — Premium Booking</title>

  <!-- Optional: use Google font with Gujarati fallback -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Noto+Sans+Gujarati:wght@400;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#071025;
      --card:#071226;
      --muted:#a9b6c6;
      --accent1:#6ee7b7;
      --accent2:#7dd3fc;
      --glass: rgba(255,255,255,0.04);
      --regular:#233044;
      --premium:#5b3be6;
      --vip:#e0a400;
      --reserved:#111827;
      --seat-size:46px;
      --shadow: 0 12px 40px rgba(2,6,23,0.65);
      font-family: "Inter", "Noto Sans Gujarati", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background:
        radial-gradient(1200px 400px at 10% 10%, rgba(124,58,237,0.08), transparent 8%),
        radial-gradient(1000px 300px at 90% 90%, rgba(34,197,94,0.03), transparent 6%),
        linear-gradient(180deg, #041223 0%, #030511 100%);
      color:#e6eef6;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding:28px;
      display:flex;
      justify-content:center;
      align-items:flex-start;
      gap:20px;
      min-height:100vh;
    }

    /* App container */
    .app{
      width:100%;
      max-width:1200px;
      border-radius:16px;
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      padding:22px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(8px);
      border: 1px solid rgba(255,255,255,0.03);
    }

    /* Topbar */
    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      margin-bottom:18px;
    }
    .brand{
      display:flex;
      gap:12px;
      align-items:center;
    }
    .logo-badge{
      width:56px;
      height:56px;
      border-radius:12px;
      display:grid;
      place-items:center;
      background:linear-gradient(135deg,var(--premium),#7c3aed);
      box-shadow: 0 8px 30px rgba(124,58,237,0.18), inset 0 -6px 16px rgba(255,255,255,0.03);
      font-weight:700;
      color:white;
      font-size:16px;
    }
    .brand h1{
      margin:0;
      font-size:18px;
      line-height:1;
    }
    .brand p{
      margin:0;
      font-size:12px;
      color:var(--muted);
    }

    .controls{
      display:flex;
      gap:12px;
      align-items:center;
    }
    .movie-select select{
      margin-left:8px;
      padding:10px 12px;
      border-radius:10px;
      background:rgba(255,255,255,0.02);
      border:1px solid rgba(255,255,255,0.04);
      color:var(--accent2);
      font-weight:600;
    }
    .location{
      font-size:13px;
      color:var(--muted);
      text-align:right;
    }
    .theater-name{
      font-weight:700;
      color:#fff;
      font-size:14px;
    }

    /* Theater layout */
    .theater{
      padding:20px;
      background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0));
      border-radius:12px;
      border: 1px solid rgba(255,255,255,0.02);
    }
    .screen{
      margin:8px auto 18px;
      width:72%;
      max-width:780px;
      text-align:center;
      padding:12px;
      border-radius:10px;
      background:linear-gradient(90deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
      color:var(--muted);
      font-weight:700;
      letter-spacing:3px;
      box-shadow: inset 0 -6px 18px rgba(0,0,0,0.45);
    }

    /* legend */
    .legend{
      display:flex;
      gap:16px;
      justify-content:center;
      margin-bottom:14px;
      color:var(--muted);
      font-size:13px;
      flex-wrap:wrap;
    }
    .legend div{
      display:flex;
      gap:8px;
      align-items:center;
      padding:6px 8px;
      background: rgba(255,255,255,0.015);
      border-radius:8px;
      border:1px solid rgba(255,255,255,0.02);
    }
    .seat-legend{
      width:18px;
      height:14px;
      border-radius:3px;
      display:inline-block;
      box-shadow:0 4px 12px rgba(2,6,23,0.5), inset 0 -2px 6px rgba(255,255,255,0.02);
    }
    .seat-legend.regular{background:linear-gradient(180deg,var(--regular),#142233)}
    .seat-legend.premium{background:linear-gradient(180deg,var(--premium),#3f23b6)}
    .seat-legend.vip{background:linear-gradient(180deg,var(--vip),#c47b00)}
    .seat-legend.reserved{background:linear-gradient(180deg,var(--reserved),#111)}

    /* seats grid */
    .seats-container{
      display:grid;
      justify-content:center;
      gap:12px 12px;
      grid-template-columns: repeat(12, var(--seat-size));
      padding:14px;
      margin:0 auto;
      max-width:calc((var(--seat-size) * 12) + 160px);
      position:relative;
      perspective: 1200px;
    }

    /* seat button */
    .seat{
      width:var(--seat-size);
      height:var(--seat-size);
      border-radius:10px;
      border:0;
      cursor:pointer;
      outline: none;
      display:inline-grid;
      place-items:center;
      font-size:12px;
      font-weight:700;
      color:transparent;
      transition: transform .18s cubic-bezier(.2,.9,.2,1), box-shadow .18s ease, opacity .12s;
      box-shadow: 0 8px 20px rgba(2,6,23,0.6), inset 0 -4px 8px rgba(255,255,255,0.02);
      position:relative;
      transform-origin: center bottom;
    }
    .seat:focus{
      transform: translateY(-6px) scale(1.05);
      box-shadow: 0 18px 40px rgba(0,0,0,0.6), 0 0 0 6px rgba(124, 58, 237, 0.06);
    }

    /* seat appearances for types */
    .seat.regular{ background:linear-gradient(180deg,#23394e,#142231); color:#bfe7d8; }
    .seat.premium{ background:linear-gradient(180deg,#6f55f3,#2f1f8a); color:#eef2ff; }
    .seat.vip{ background:linear-gradient(180deg,#f3c24d,#a06b00); color:#2b1b00; }
    .seat.reserved{
      background:linear-gradient(180deg,#0b1120,#07090a);
      pointer-events:none;
      opacity:0.4;
      color:transparent;
      transform:none !important;
    }

    /* selected state */
    .seat.selected{
      transform: translateY(-10px) scale(1.08) rotateX(6deg);
      box-shadow: 0 28px 60px rgba(0,0,0,0.7), 0 0 0 8px rgba(110,231,183,0.04);
      filter:brightness(1.08) saturate(1.06);
    }

    /* show price label on hover */
    .seat[data-price]:not(.reserved):hover::after{
      content: attr(data-price);
      position:absolute;
      left:50%;
      transform:translate(-50%,-62px);
      font-size:12px;
      padding:6px 10px;
      border-radius:8px;
      background:linear-gradient(180deg, rgba(0,0,0,0.85), rgba(6,10,15,0.95));
      color:var(--accent2);
      pointer-events:none;
      box-shadow:0 12px 30px rgba(2,6,23,0.5);
      white-space:nowrap;
    }

    /* aisle spacing: add gap between cols 6 and 7 */
    .seats-container .aisle{
      grid-column: 7 / 8;
      width:12px;
      pointer-events:none;
      background:transparent;
    }

    /* small screen */
    @media (max-width:800px){
      :root{--seat-size:40px}
      .seats-container{grid-template-columns: repeat(8, var(--seat-size)); max-width:calc((var(--seat-size) * 8) + 80px);}
      .screen{width:88%}
    }

    /* summary / actions */
    .summary{
      margin-top:18px;
      display:flex;
      gap:12px;
      justify-content:space-between;
      color:var(--muted);
      padding:12px 14px;
      border-radius:12px;
      background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005));
      align-items:center;
      border:1px solid rgba(255,255,255,0.02);
    }
    .summary .big{
      font-weight:700;
      color:#fff;
    }
    .actions{
      margin-top:14px;
      display:flex;
      gap:10px;
      justify-content:center;
      align-items:center;
    }
    .btn{
      padding:10px 14px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,0.06);
      background:transparent;
      color:var(--accent2);
      cursor:pointer;
      font-weight:700;
      letter-spacing:0.3px;
    }
    .btn.primary{
      background:linear-gradient(90deg,var(--accent1),var(--accent2));
      color:#012018;
      border:0;
      box-shadow: 0 12px 36px rgba(110,231,183,0.06);
    }
    .btn.ghost{
      background:transparent;
      border:1px solid rgba(255,255,255,0.06);
      color:var(--muted);
    }

    /* footer */
    .footer{
      margin-top:12px;
      color:var(--muted);
      text-align:center;
      font-size:13px;
    }

    /* small decorative */
    .pulse {
      animation: pulse 2.6s infinite;
    }
    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(124,58,237,0.08); }
      70% { box-shadow: 0 0 0 18px rgba(124,58,237,0); }
      100% { box-shadow: 0 0 0 0 rgba(124,58,237,0); }
    }
  </style>
</head>
<body>
  <main class="app" role="application">
    <header class="topbar">
      <div class="brand">
        <div class="logo-badge pulse">CL</div>
        <div>
          <h1>CineLux Cinema</h1>
          <p class="theater-name"> Vadodara, Gujarat</p>
        </div>
      </div>

      <div class="controls">
        <div class="location" aria-hidden="false">
          <div style="font-weight:700">Showtime: Today · 7:30 PM</div>
          <div style="color:var(--muted)">Location: Alkapuri, Vadodara • Near Sayaji Baug</div>
        </div>

        <label class="movie-select" style="display:flex; align-items:center; gap:6px;">
          <strong style="color:var(--muted); font-size:13px">Movie</strong>
          <select id="movie" aria-label="Choose movie">
            <!-- values are base ticket prices in INR -->
            <option value="180">Raktbeej — રક્તબીજ</option>
            <option value="220">Fakt Mahilao Maate 2 — ફક્ત મહિલાઓ માટે ૨</option>
            <option value="150">Hun Aapne Buddhi Aapne — હું આપણે બુદ્ધિ આપણે</option>
            <option value="200">Bushirt T-Shirt — બુશર્ટ ટી-શર્ટ</option>
            <option value="140">Chhello Divas — છેલ્લો દિવસ</option>
            <option value="170">Shubh Yatra — શુભ યાત્રા</option>
          </select>
        </label>

        <button id="reset" class="btn ghost" title="Reset selection">Reset</button>
      </div>
    </header>

    <section class="theater" aria-label="Theater seating">
      <div class="screen">SCREEN</div>

      <div id="legend" class="legend" aria-hidden="false">
        <div><span class="seat-legend regular"></span> Regular</div>
        <div><span class="seat-legend premium"></span> Premium (+ ₹ 40)</div>
        <div><span class="seat-legend vip"></span> VIP (+ ₹ 90)</div>
        <div><span class="seat-legend reserved"></span> Reserved</div>
      </div>

      <div id="seatsContainer" class="seats-container" role="grid" aria-label="Seat map"></div>

      <div class="summary" aria-live="polite">
        <div>
          <div style="font-size:13px; color:var(--muted)">Selected</div>
          <div class="big" id="count">0</div>
        </div>

        <div style="flex:1; text-align:center;">
          <div style="font-size:13px; color:var(--muted)">Seats</div>
          <div class="big" id="seatList">—</div>
        </div>

        <div style="text-align:right;">
          <div style="font-size:13px; color:var(--muted)">Total</div>
          <div class="big" id="total">₹ 0</div>
        </div>
      </div>

      <div class="actions" style="justify-content:center; margin-top:12px;">
        <button id="confirm" class="btn primary">Confirm Booking</button>
        <button id="demoReserve" class="btn ghost">Toggle Reserved</button>
      </div>
    </section>

    <footer class="footer">
      <small>Access: Tab to focus a seat, Enter / Space to select. Prices are in INR (₹).</small>
    </footer>
  </main>

  <script>
    (function(){
      // Config
      const ROWS = 8;
      const COLS = 12;
      // surcharge amounts in INR
      const seatTypeConfig = {
        regular: { name: 'Regular', add: 0 },
        premium: { name: 'Premium', add: 40 },
        vip:     { name: 'VIP', add: 90 }
      };

      // Elements
      const seatsContainer = document.getElementById('seatsContainer');
      const movieSelect = document.getElementById('movie');
      const countEl = document.getElementById('count');
      const totalEl = document.getElementById('total');
      const seatListEl = document.getElementById('seatList');
      const resetBtn = document.getElementById('reset');
      const confirmBtn = document.getElementById('confirm');
      const demoReserveBtn = document.getElementById('demoReserve');

      // currency formatter for India
      const money = v => new Intl.NumberFormat('en-IN', { style:'currency', currency:'INR', maximumFractionDigits:0 }).format(v);

      // Build seat layout data. We'll assign seat types by row:
      // - front 2 rows: vip
      // - next 2 rows: premium
      // - rest: regular
      function seatTypeForRow(r){
        if (r < 2) return 'vip';
        if (r < 4) return 'premium';
        return 'regular';
      }

      // Initialize reserved seats randomly for demo (or from storage).
      function initialReservedSet(){
        const reserved = new Set();
        const total = ROWS * COLS;
        const reserveCount = Math.floor(total * 0.08); // ~8% reserved
        while (reserved.size < reserveCount){
          const idx = Math.floor(Math.random() * total);
          reserved.add(idx);
        }
        return reserved;
      }

      // state
      const state = {
        seats: [], // array of {row, col, index, type, reserved, selected}
        reservedSet: new Set(),
        selectedSet: new Set(),
        basePrice: Number(movieSelect.value) || 180
      };

      // Persistence keys
      const STORAGE_KEY = 'cinelux_vadodara_booking_v1';

      // Load saved state
      function loadStorage(){
        try {
          const raw = localStorage.getItem(STORAGE_KEY);
          if (!raw) return;
          const obj = JSON.parse(raw);
          if (obj.movie) movieSelect.value = String(obj.movie);
          if (Array.isArray(obj.selected)) state.selectedSet = new Set(obj.selected);
          if (Array.isArray(obj.reserved)) state.reservedSet = new Set(obj.reserved);
        } catch (e) {
          console.warn('Could not load storage', e);
        }
      }

      // Save selected + reserved + movie
      function saveStorage(){
        const payload = {
          movie: Number(movieSelect.value),
          selected: Array.from(state.selectedSet),
          reserved: Array.from(state.reservedSet)
        };
        localStorage.setItem(STORAGE_KEY, JSON.stringify(payload));
      }

      // Build seats
      function buildSeats(){
        state.seats = [];
        let idx = 0;
        for (let r = 0; r < ROWS; r++){
          for (let c = 0; c < COLS; c++){
            const type = seatTypeForRow(r);
            state.seats.push({
              row: r,
              col: c,
              index: idx,
              type,
              reserved: state.reservedSet.has(idx),
              selected: state.selectedSet.has(idx),
            });
            idx++;
          }
        }
      }

      // Render seat buttons into DOM
      function renderSeats(){
        seatsContainer.innerHTML = '';
        state.seats.forEach(s => {
          const btn = document.createElement('button');
          btn.className = 'seat ' + (s.type) + (s.reserved ? ' reserved' : '') + (s.selected && !s.reserved ? ' selected' : '');
          btn.setAttribute('role','gridcell');
          btn.setAttribute('aria-label', `Row ${s.row + 1} Seat ${s.col + 1} ${ s.type } ${s.reserved ? 'reserved' : ''}`);
          btn.setAttribute('data-index', s.index);
          const priceAdd = seatTypeConfig[s.type].add;
          const displayPrice = Number(movieSelect.value) + priceAdd;
          btn.setAttribute('data-price', money(displayPrice));
          btn.tabIndex = s.reserved ? -1 : 0;
          // show short label (row-col)
          btn.textContent = `${String.fromCharCode(65 + (s.row % 26))}${s.col+1}`;
          if (s.reserved) {
            btn.setAttribute('aria-disabled','true');
            // small reserved icon
            btn.innerHTML = '&#128274;'; // lock icon
          }

          // click / keyboard
          btn.addEventListener('click', () => toggleSelect(s.index));
          btn.addEventListener('keydown', (ev) => {
            if (ev.code === 'Space' || ev.key === ' ' || ev.key === 'Enter') {
              ev.preventDefault();
              toggleSelect(s.index);
            }
          });

          seatsContainer.appendChild(btn);

          // insert an aisle after col 6 to create a realistic gap (only once per row)
          if (s.col === 5) {
            const gap = document.createElement('div');
            gap.className = 'aisle';
            // place grid break — we rely on DOM order so will appear next in flow
            seatsContainer.appendChild(gap);
          }
        });
      }

      // Toggle selection (if not reserved)
      function toggleSelect(index){
        const seat = state.seats[index];
        if (!seat || seat.reserved) return;
        if (state.selectedSet.has(index)) {
          state.selectedSet.delete(index);
          seat.selected = false;
        } else {
          state.selectedSet.add(index);
          seat.selected = true;
        }
        saveStorage();
        renderSeats();
        updateSummary();
      }

      // Update summary counts / total
      function updateSummary(){
        const selected = Array.from(state.selectedSet).sort((a,b)=>a-b);
        countEl.textContent = selected.length;
        if (selected.length === 0) {
          seatListEl.textContent = '—';
        } else {
          seatListEl.textContent = selected.map(i => {
            const s = state.seats[i];
            return `${String.fromCharCode(65 + (s.row % 26))}${s.col+1}`;
          }).join(', ');
        }

        // calculate total
        const base = Number(movieSelect.value) || state.basePrice;
        let total = 0;
        selected.forEach(i => {
          const s = state.seats[i];
          total += base + seatTypeConfig[s.type].add;
        });
        totalEl.textContent = money(total);
      }

      // Update seat prices when movie changes
      function onMovieChange(){
        saveStorage();
        renderSeats();
        updateSummary();
      }

      // Reset selection (not reserved)
      function resetSelection(){
        state.selectedSet.clear();
        state.seats.forEach(s => s.selected = false);
        saveStorage();
        renderSeats();
        updateSummary();
      }

      // Demo toggler: toggles random reserved seats (useful to demonstrate persistence)
      function demoToggleReserved(){
        const total = state.seats.length;
        for (let i=0;i<6;i++){
          const idx = Math.floor(Math.random() * total);
          if (state.reservedSet.has(idx)) state.reservedSet.delete(idx);
          else state.reservedSet.add(idx);
        }
        // ensure selected seats not reserved
        for (const sel of Array.from(state.selectedSet)){
          if (state.reservedSet.has(sel)) state.selectedSet.delete(sel);
        }
        buildSeats();
        saveStorage();
        renderSeats();
        updateSummary();
      }

      // Confirm booking: simple confirmation + move selected -> reserved
      function confirmBooking(){
        if (state.selectedSet.size === 0){
          alert('No seats selected. Please choose seats before confirming.');
          return;
        }
        const ok = confirm(`Confirm booking for ${state.selectedSet.size} seat(s)?`);
        if (!ok) return;
        // move selected seats to reserved
        for (const idx of Array.from(state.selectedSet)){
          state.reservedSet.add(idx);
        }
        state.selectedSet.clear();
        buildSeats();
        saveStorage();
        renderSeats();
        updateSummary();
        alert('Booking confirmed! Reserved seats updated.');
      }

      // Setup & init
      function init(){
        loadStorage();
        // if no saved reserved, create an initial set
        if (!window.localStorage.getItem(STORAGE_KEY)) {
          state.reservedSet = initialReservedSet();
        }
        buildSeats();
        renderSeats();
        updateSummary();

        // events
        movieSelect.addEventListener('change', onMovieChange);
        resetBtn.addEventListener('click', () => {
          if (!confirm('Reset selection and saved movie?')) return;
          localStorage.removeItem(STORAGE_KEY);
          window.location.reload();
        });
        demoReserveBtn.addEventListener('click', demoToggleReserved);
        confirmBtn.addEventListener('click', confirmBooking);
      }

      init();
    })();
  </script>
</body>
</html>
